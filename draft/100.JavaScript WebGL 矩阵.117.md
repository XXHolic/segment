# 100.JavaScript WebGL 矩阵.117
## <a name="index"></a> 目录
- [引子](#start)
- [帧缓冲区对象](#concept)
- [示例](#example)
- [观察及思考](#think)
- [参考资料](#reference)

## <a name="start"></a> 引子
本以为可以开始尝试三维的效果了，查了一下资料之后发现要先了解矩阵。在这里集中收集一下相关基础知识点。

## <a name="intro"></a> 简介
简单来说，矩阵（Matrix）是数字按行和列的矩形排列。一般描述先行后列，例如下面 2×3 矩阵：

![100-1][url-local-1]

矩阵中每个元素表示也可以根据行和列标记，例如 a<sub>1,2</sub> 表示第 1 行的第 2 列元素。

- 在应用数学学科中，矩阵常见于统计分析。
- 在物理学中，矩阵于电路学、力学、光学和量子物理中都有应用。
- 计算机科学中，三维动画制作也需要用到矩阵。

## <a name="one"></a> 单位矩阵
单位矩阵有如下特点：
- 行数和列数相等。
- 对角线全是 1，其他全是 0 。
- 符号为大写字母 I 。
- 与任何矩阵相乘不会产生改变，例如 A × I = A。

下面是 3×3 单位矩阵：

![100-2][url-local-2]

## <a name="one"></a> 负矩阵
简单来说就是矩阵里面每个元素求反。

例如矩阵 A 如下：

![100-3][url-local-3]

对应负矩阵就是：

![100-4][url-local-4]

## <a name="one"></a> 转置
转置就是把矩阵的列和行对换。在右上角放一个 T 表示转置：

![100-8][url-local-8]

转置满足以下运算律：
- (A<sup>T</sup>)<sup>T</sup> = A
- (λA)<sup>T</sup> = λA<sup>T</sup>
- (AB)<sup>T</sup> = A<sup>T</sup>B<sup>T</sup>


## <a name="cal"></a> 基本运算
### 加法
只有同型（行数和列数对应相等）矩阵才能进行相加。相加时，对应的位置数进行相加。示例如下：

![100-5][url-local-5]

加法满足以下运算律：
- A + B = B + A
- (A + B) + C = A + (B + C)

### 减法
减法实际上就是与负矩阵相加。前提条件也是要是同型矩阵。示例如下：

![100-6][url-local-6]

### 矩阵与数相乘
矩阵与一个数相乘，矩阵中每个元素与数相乘。示例如下：

![100-7][url-local-7]

数乘满足一下运算律：
- λ(μA) = μ(λA)
- λ(μA) = (λμ)A
- (λ + μ)A = λA + λμ
- λ(A + B) = λA + λB

### 矩阵与矩阵相乘
两个矩阵能相乘的前置条件是：第一个矩阵的**列数**必须等于第二个矩阵的**行数**。

m×n 矩阵 A 乘以 n×p 矩阵 B 得到的是一个 m×p 矩阵 C 。矩阵 C 中每个元素的计算方式为：

![100-9][url-local-9]

[这里][url-5]有个结合实例的解释，下面是计算示例：

![100-10][url-local-10]

- c<sub>1,1</sub> = a<sub>1,1</sub> × b<sub>1,1</sub> + a<sub>1,2</sub> × b<sub>2,1</sub> + a<sub>1,3</sub> × b<sub>3,1</sub> = 0×1 + 1×2 + 2×3 = 8
- c<sub>1,2</sub> = a<sub>1,1</sub> × b<sub>1,2</sub> + a<sub>1,2</sub> × b<sub>2,2</sub> + a<sub>1,3</sub> × b<sub>3,2</sub> = 0×4 + 1×5 + 2×6 = 17
- c<sub>2,1</sub> = a<sub>2,1</sub> × b<sub>1,1</sub> + a<sub>2,2</sub> × b<sub>2,1</sub> + a<sub>2,3</sub> × b<sub>3,1</sub> = 2×1 + 1×2 + 0×3 = 4
- c<sub>2,2</sub> = a<sub>2,1</sub> × b<sub>1,2</sub> + a<sub>2,2</sub> × b<sub>2,2</sub> + a<sub>2,3</sub> × b<sub>3,2</sub> = 2×4 + 1×5 + 0×6 = 13

矩阵相乘满足一下运算律：
- (AB)C = A(BC)
- (A + B)C = AC + BC
- C(A + B) = CA + CB

这里需要注意矩阵相乘不满足互换律，也就是 AB != BA 。

### <a name="reverse"></a> 逆矩阵
数有倒数，矩阵有类似的概念，叫逆矩阵，表示形式为 A<sup>-1</sup> 。数与倒数的乘积为 1 ，类似的，矩阵与逆矩阵相乘结果是单位矩阵：AA<sup>-1</sup> = I 。

行数和列数相等的矩阵才可能有逆矩阵。更详细的讲解见[这里][url-4]。

计算逆矩阵的方式是：
- [用初等行运算][url-6]
- [用余子式、代数余子式和伴随矩阵][url-7]

这个有什么作用？这个会在下面除法中讲到。

### 矩阵与矩阵相除
在矩阵中是没有除的概念，乘以逆矩阵，这和除是相同的效果。

假设已知矩阵 A 和 B ，且 A 存在逆矩阵，需要求矩阵 X ：
```
XA = B
```
可以这样做：
- XAA<sup>-1</sup> = BA<sup>-1</sup>

前面有提到 AA<sup>-1</sup> = I，所以：
- XI = BA<sup>-1</sup>

单位矩阵相乘是不会改变原矩阵的，所以：
- X = BA<sup>-1</sup>

## 矩阵与向量相乘
矩阵与向量相乘是方程组的一种解释方式，具体解释看[这里][url-8]，有两条重要的规律：
- 矩阵乘以右侧列向量可看成矩阵各列向量的线性组合，结果为列向量。
- 左侧行向量乘以矩阵可看成矩阵各行向量的线性组合，结果为行向量。

WebGL 中的顶点坐标都可以转换为向量的形式，进行变换时，向量和矩阵相乘是一种高效的方式。先看看二维变换：位移、缩放和旋转。

## 二维位移
先看下不使用矩阵位移的方式，坐标(x, y)，分量对应位移 T<sub>x</sub> 和 T<sub>y</sub>，那么新坐标：
- newX = x + T<sub>x</sub>
- newY = y + T<sub>y</sub>

单位矩阵通常是生成其它变换矩阵的起点，向量与单位矩阵相乘不会改变向量：

![100-11][url-local-11]

矩阵的计算方式与非矩阵的计算方式对比：
- newX = x + T<sub>x</sub>
- newX = 1 * x + 0 * y

发现用 2×2 矩阵变换不行，需要 3×3 矩阵 。向量也要多一个分量才能相乘，这里设置为 1 ，再来看下计算：

![100-12][url-local-12]

这样得到的结果就符合了位移效果。

## 二维缩放
缩放量为 S<sub>x</sub> 和 S<sub>y</sub> ，2×2 矩阵就可以满足缩放的效果：

![100-13][url-local-13]

## 二维旋转





<div align="right"><a href="#index">Back to top :arrow_up:</a></div>


## <a name="reference"></a> 参考资料
- [矩阵百科][url-1]
- [矩阵][url-2]
- [WebGL 二维矩阵][url-3]

[url-1]:https://baike.baidu.com/item/%E7%9F%A9%E9%98%B5/18069?fr=aladdin
[url-2]:https://www.shuxuele.com/algebra/matrix-introduction.html
[url-3]:https://webglfundamentals.org/webgl/lessons/zh_cn/webgl-2d-matrices.html
[url-4]:https://www.shuxuele.com/algebra/matrix-inverse.html
[url-5]:https://www.shuxuele.com/algebra/matrix-multiplying.html
[url-6]:https://www.shuxuele.com/algebra/matrix-inverse-row-operations-gauss-jordan.html
[url-7]:https://www.shuxuele.com/algebra/matrix-inverse-minors-cofactors-adjugate.html
[url-8]:https://zhuanlan.zhihu.com/p/43759544

[url-9]:https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/checkFramebufferStatus


[url-local-1]:../images/100/1.png
[url-local-2]:../images/100/2.svg
[url-local-3]:../images/100/3.svg
[url-local-4]:../images/100/4.svg
[url-local-5]:../images/100/5.svg
[url-local-6]:../images/100/6.svg
[url-local-7]:../images/100/7.svg
[url-local-8]:../images/100/8.svg
[url-local-9]:../images/100/9.svg
[url-local-10]:../images/100/10.svg
[url-local-11]:../images/100/11.svg
[url-local-12]:../images/100/12.svg
[url-local-13]:../images/100/13.svg

<details>
<summary>:wastebasket:</summary>



</details>

[url-art]:https://movie.douban.com/subject/35376457/
[url-local-poster]:../images/99/poster.png
